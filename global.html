<!DOCTYPE HTML>
<html>
	<head>
		<script type="text/javascript">
		safari.application.addEventListener("contextmenu",handleContextMenu,false);
		safari.application.addEventListener("command",performCommand,false);
		
		function handleContextMenu(event) {
			if(event.userInfo!=null) {
				if(event.userInfo.address!=null) {
					event.contextMenu.appendContextMenuItem("addLabel","Add label for "+event.userInfo.address);
				}
				event.contextMenu.appendContextMenuItem("saveAddresses","Save bitcoin addresses");
			}
		}
		
		function performCommand(event) {
			if(event.command==="addLabel") {
				event.currentTarget.activeBrowserWindow.activeTab.page.dispatchMessage("addLabel",event.userInfo.address[0]);
			}
			else if(event.command==="saveAddresses") {
				event.currentTarget.activeBrowserWindow.activeTab.page.dispatchMessage("saveAddresses",null);
			}
		}
		</script>
	</head>
	<body></body>
</html>